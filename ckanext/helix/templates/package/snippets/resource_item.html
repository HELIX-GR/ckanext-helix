{% set can_edit = h.check_access('package_update', {'id':pkg.id }) %}
{% set url_action = 'resource_edit' if url_is_edit and can_edit else 'resource_read' %}
{% set url = h.url_for(controller='package', action=url_action, id=pkg.name, resource_id=res.id) %}

<div class="page__content__default__attachment" data-id="{{ res.id }}">
    {% block resource_item_header %}

    {% block resource_item_title %}

    <div class="page__content__default__attachment__icon">
        {#<span class="format-label" property="dc:format"
        data-format="{{ res.format.lower() or 'data' }}"></span>#}
        <svg xmlns="http://www.w3.org/2000/svg" width="87.184" height="101.714" viewBox="0 0 87.184 101.714">
            <path id="Path_1724" data-name="Path 1724"
                d="M83.324-22.145a13.206,13.206,0,0,1,2.724,4.314,13.1,13.1,0,0,1,1.135,4.995V52.551A5.426,5.426,0,0,1,81.735,58H5.449a5.255,5.255,0,0,1-3.86-1.589A5.255,5.255,0,0,1,0,52.551V-38.265a5.255,5.255,0,0,1,1.589-3.86,5.255,5.255,0,0,1,3.86-1.589H56.306A13.1,13.1,0,0,1,61.3-42.579a13.206,13.206,0,0,1,4.314,2.724Zm-25.2-13.849v21.342H79.464a6.2,6.2,0,0,0-1.249-2.327L60.45-34.746A6.2,6.2,0,0,0,58.122-35.995Zm21.8,86.73V-7.388H56.306a5.255,5.255,0,0,1-3.86-1.589,5.255,5.255,0,0,1-1.589-3.86V-36.449H7.265V50.735ZM24.35,37.453v6.017H40.3V37.453H36.043l5.846-9.138a8.138,8.138,0,0,0,.568-.937q.284-.539.426-.766t.2-.227h.114a1.957,1.957,0,0,0,.284.568,3.17,3.17,0,0,0,.255.426q.142.2.341.454t.369.482l6.073,9.138H46.2v6.017H62.72V37.453H58.86l-10.9-15.5L59.031,5.951h3.8V-.122H47V5.951h4.2l-5.846,9.025q-.227.4-.568.937t-.511.766l-.114.17h-.114a1.957,1.957,0,0,0-.284-.568,6.77,6.77,0,0,0-.965-1.305L36.781,5.951h4.314V-.122H24.634V5.951h3.86L39.221,21.39,28.21,37.453Z"
                transform="translate(0 43.714)" fill="#971035" />
        </svg>
    </div>
    <div class="page__content__default__attachment__main {% if in_resource %} in-resource {% endif%} ">
        <div class="page__content__default__attachment__filename">
            <a class="resource-title" href="{{ url }}" title="{{ res.name or res.description }}"> 
                {{ h.resource_display_name(res) }}</a>
            {#{% if res.can_be_previewed %}
                <i class="icon-eye-open"></i>
                {% else %}
                <i class="fa fa-info-circle"></i>
                {% endif %} #}
        </div>
        {#{{ h.popular('views', res.tracking_summary.total, min=10) }} #}

        {% endblock %} {# resource_item_title #}
        {% block resource_item_explore %}
        {% if not url_is_edit %}
        {#  {% if can_edit %} #}
        <!-- <div class="action-button"><a class="btn" href="{{ h.url_for(controller='package', action='resource_edit', id=pkg.name, resource_id=res.id) }}">
                      <i class="icon-edit"></i> {{ _('Edit') }}
              </a></div> -->
        {#   {% endif %} #}
        {#{% if res.resource_type == 'file' %} #}
        {% block resource_item_file %}
        {# Placeholder for extra data/resources buttons #}
        {% endblock %}


        {#{% if raster_resources|length>0 or vector_resources|length>0 %} 
            <a class="btn btn-primary dropdown-toggle" data-toggle="modal" data-module-id={{res.id}} data-target="#download_options-{{res.id}}" data-module="download_options_dialog" >
                <span class="icon-reorder"></span>
            </a>
            {% snippet 'package/snippets/download_options.html', pkg=pkg, res=res %}

            {% endif %} #}

        {% if res.resource_type == 'api' %}
        {% block resource_item_service %}
        {# Placeholder for extra service buttons #}

        <div class="action-button">
            <a href="{{ res.url }}" class="btn resource-url-analytics" target="_blank">
                <i class="icon-beaker"></i>
                {{ _('Endpoint') }}
            </a>
        </div>
        {% endblock %}

        {% endif %}

        {% endif %} {# url_is_edit #}

        {% endblock %} {# resource_item_explore #}


        {% endblock %} {# resource_item_header #}


        {% block resource_item_description %}
        <div class="page__content__default__attachment__details">
            {% if res.description %}
            {{ h.markdown_extract(res.description, extract_length=120) -}}
            {% else %}
            {{ _('No description') }}
            {% endif %}
        </div>
        {% if res.format %}
        <div class="page__content__default__attachment__button"> <a class=" btn btn--simple" href="{{ res.url }}"> {{ _('Download') }}</a></div>

        {% endif %}
    </div>
    {% block resource_languages %}
    {% endblock %}

    {% endblock %} {# resource_item
        _description #}

</div>